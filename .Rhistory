a[length(a) + 1] = i
}
}
dat <- dat[-a, ]
} #kiszurjuk azokat az adatokat, amelyek Romaniaba vannak
{
#nPolys <- sapply(regi@polygons, function(x)length(x@Polygons)) #megmondja hogy melyik polygon, hany reszbol all
regi_f <- fortify(regi)
nPolys <- unique(regi_f$id) #a kulombozo regioknak az azonositoi, osszesen 16
regi_fl = list()
nevek <- numeric(length(nPolys))
for (i in 1:length(nPolys)) {
nevek[i] <- unlist(strsplit(as.character(regi$DENUMIRE[i]), ' - '))[2]
}
for (i in 1:length(nPolys)) {
new_shape_1 <- point.in.polygon(dat$lon, dat$lat, regi_f[regi_f$id == nPolys[i],]$long, regi_f[regi_f$id == nPolys[i],]$lat)
new_shape_2 <- numeric(0)
for (j in 1:length(new_shape_1)) {
if (new_shape_1[j] == 0) {
new_shape_2[length(new_shape_2) + 1] <- j
}
}
fajok <- dat[-new_shape_2,]
corr <- length(unique(fajok$sp))/((regi$Terulet[i]/1000)^0.15) #a terulet milyen formaba szerepeljen?
regi_fl[[i]] <- list(adatok = data.frame(nev = nevek[i],
terulet = regi$Terulet[i],
telj_fsz = length(unique(fajok$sp)),
corr_fsz = corr,
gyujtesi_pontok_sz = nrow(unique(fajok[,c('lon', 'lat')])),
egyedszam = sum(fajok$egyed)),
fajok = fajok)
}
#a regi_fl[[1]][[1]] tartalmazza a regio nevet, a regi_fl[[1]][[2]] tartalmazza a regioba talalhato pontokat
#rei_fl[[i]] az i edik regio informacioi (osszesen 16 van)
#pl: regi_fl[[2]][[2]][1,] parancsal lehet elerni a masodik listaba levo data frame elemeit
} #regionkent lekerdezzuk a pontokat
{
centroids <- data.frame(gCentroid(regi, byid = TRUE))
centroids$regiune <- regi$REGIUNE
s <-
c(
'podis' ,
'campie',
'carpati',
'depresiune',
'dealuri',
'carpati',
'dealuri',
'carpati',
'carpati',
'carpati',
'dealuri',
'campie',
'podis',
'podis',
'campie',
'carpati'
)
ggplot() +
scale_x_continuous(name="") +
scale_y_continuous(name="") +
geom_polygon(data = rom, aes(long, lat, group=group), colour='black',fill='white') +
geom_point(data = centroids, aes(x = x, y = y, shape = factor(s), colour = factor(s)), size = 4) +
geom_text(data = centroids, vjust = 0, nudge_y = 0.1, aes(x = x, y = y, label = centroids$regiune))
} #regionkenti centroidok meghatarozasa + kategorizalas
{
df <- data.frame(matrix(vector(), 0, 6, dimnames = list(c(), c('regio', 'terulet', 'teles_fajszam', 'korrekcios_fajszam', 'gyujtesi_pontok_sz', 'egyedszam'))), stringsAsFactors=F)
for (i in 1:length(regi_fl)) {
df[i,]$regio <- nevek[i]
df[i,]$terulet <- regi_fl[[i]]$adatok$terulet
df[i,]$teles_fajszam <- regi_fl[[i]]$adatok$telj_fsz
df[i,]$korrekcios_fajszam <- regi_fl[[i]]$adatok$corr_fsz
df[i,]$gyujtesi_pontok_sz <- regi_fl[[i]]$adatok$gyujtesi_pontok_sz
df[i,]$egyedszam <- regi_fl[[i]]$adatok$egyedszam
}
} #Statisztikahoz elokeszitjuk az adatokat
honapok <- c('jan', 'feb', 'mar', 'apr', 'maj', 'jun', 'jul', 'aug', 'sep', 'okt', 'nov', 'dec')
aktivi <- matrix(rep(NA, length(nevek)*length(honapok)), nrow = length(nevek))
colnames(aktivi) <- honapok
rownames(aktivi) <- nevek
aktivi
regi_fl[[2]]$fajok
regi_fl[[2]]$fajok[,4]
regi_fl[[2]]$fajok[,4:5]
sapply(regi_fl, function(i) {sapply(i$fajok[,4:5], identity)})
regi_fl[[2]]$fajok[,4:5]
sapply(regi_fl, function(i) {sapply(i$fajok[,4:5])})
sapply(regi_fl, function(i) {
sapply(i$fajok[, 4:5], function(j) {
return(j)
})
})
sapply(regi_fl, function(i) {
sapply(i$fajok[, 4:5], function(j) {
return(j)
}, simplify = T)
})
ak <- sapply(regi_fl, function(i) {
sapply(i$fajok[, 4:5], function(j) {
return(j)
}, simplify = T)
})
ak
ak[1]
ak[2]
ak[[2]]$datum
ak[,2]
ak[2]
ak[2][2]
ak[2][1]
unlist(ak)
unlist(ak[2])
ak <- unlist(ak[2])
class(ak[14])
as.Date(ak[14])
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j)
}, simplify = T)
})
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j)
})
})
ak
ak[[2]]
regi_fl[[2]]
ak <- lapply(regi_fl[[2]], function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j)
})
})
ak
ak <- lapply(regi_fl[[2:3]], function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j)
})
})
ak <- lapply(regi_fl[[c(2:3)]], function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j)
})
})
ak <- lapply(regi_fl, function(i) {
lapply(as.data.frame(i$fajok[, 4:5]), function(j) {
return(j)
})
})
ak
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j)
})
})
ak
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(sum(j[,1]))
})
})
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
a <- sum(j[,1])
return(a)
})
})
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j[,1])
})
})
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j[1])
})
})
ak
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j$egyed)
})
})
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j)
})
})
ak
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j[[2]])
})
})
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j[2])
})
})
ak
ak[[2]]
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j)
})
})
ak[[2]]
ak[[2]]$egyed
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j$egyed)
})
})
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], identify)
})
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], identity)
})
ak
ak <- lapply(regi_fl, function(i) {
lapply(as.data.frame(i$fajok[, 4:5]), identity)
})
ak
ak <- lapply(regi_fl, function(i) {
lapply(as.data.frame(i$fajok[, 4:5]), function(j) {
return(j$egyed)
})
})
ak <- lapply(regi_fl, function(i) {
lapply(as.data.frame(i$fajok[, 4:5]), function(j) {
return(j$egyed)
})
})
ak <- lapply(regi_fl, function(i) {
lapply(unlist(i$fajok[, 4:5]), function(j) {
return(j)
})
})
ak
ak[[2]]
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(unlist(j))
})
})
ak
ak <- lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j[2])
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j[2])
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j[[2]])
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j[2,])
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(class(j))
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok, function(j) {
return(class(j))
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok, function(j) {
return(j[[2]])
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok, function(j) {
return(j[[2]][[1]])
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok, function(j) {
return(j[[2]][1])
})
})
ak <- regi_fl[[2]]
ak
lapply(ak, function(i) {
return(i$fajok)
})
lapply(ak, function(i) {
return(i)
})
lapply(ak, function(i) {
return(i[[2]])
})
lapply(ak, function(i) {
return(i$fajok[[2]])
})
lapply(ak, function(i) {return(i$fajok[2])})
lapply(ak, function(i) {return(i$fajok)})
lapply(ak, function(i) {return(i$fajok[[2]][[2]])})
lapply(ak, function(i) {return(i$fajok[[1]][[2]])})
lapply(ak, function(i) {return(i)})
as.data.frame(lapply(ak, function(i) {return(i)}))
}
lapply(ak, function(i) {return(as.data.frame(i))})
lapply(as.data.frame(ak), function(i) {return(i)})
lapply(as.data.frame(ak), function(i) {return(i$fajok)})
lapply(ak, function(i) {return(i)})
sapply(ak, function(i) {return(i)})
sapply(ak, function(i) {return(i$fajok)})
sapply(ak, function(i) {return([[i]])})
sapply(ak, function(i) {return(i[,2])})
sapply(ak, function(i) {return(i[[1]][,2])})
sapply(ak, function(i) {return(i[1][,2])})
sapply(ak, function(i) {return(i[,1][,2])})
sapply(ak, function(i) {return(i[,2]$fajok)})
sapply(ak, function(i) {return(i[1,2])})
sapply(ak, socketSelect(ak))
sapply(ak, socketSelect(fajok))
sapply(ak, function(i) {return(i[['fajok']])})
sapply(ak, function(i) {return(i$fajok)})
sapply(ak, function(i) {return(i['fajok'])})
sapply(ak,
function(i) {
return(i['fajok'])
})
sapply(ak,
function(i) {
browser()
return(i)
})
View(i)
sapply(ak,
function(i) {
browser()
return(i)
})
View(i)
sapply(ak,
function(i) {
browser()
return(i$nev)
})
View(i)
View(i)
sapply(ak,
function(i) {
#browser()
return(i$nev)
})
lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
return(j)
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
browser()
return(j)
})
})
lapply(regi_fl, function(i) {
sapply(i$fajok[, 4:5], function(j) {
#browser()
return(j)
})
})
sapply(regi_fl, function(i) {
lapply(i$fajok[, 4:5], function(j) {
#browser()
return(j)
})
})
sapply(regi_fl, function(i) {
sapply(i$fajok[, 4:5], function(j) {
#browser()
return(j)
})
})
sapply(regi_fl, function(i) {
sapply(i$fajok[, 4:5], function(j) {
browser()
return(j)
})
})
sapply(regi_fl, function(i) {
sapply(i$fajok, function(j) {
#browser()
return(j)
})
})
sapply(regi_fl, function(i) {
lapply(i$fajok, function(j) {
#browser()
return(j)
})
})
lapply(regi_fl, function(i) {
lapply(i$fajok, function(j) {
#browser()
return(j)
})
})
lapply(regi_fl, function(i) {
sapply(i$fajok, function(j) {
#browser()
return(j)
})
})
lapply(regi_fl, function(i) {
sapply(i$fajok, function(j) {
browser()
return(j)
})
})
lapply(regi_fl, function(i) {
return(i$fajok$datum)
})
lapply(regi_fl, function(i) {
return(i$fajok[,4:5])
})
regi_fl[[2]]$fajok[,1]$datum
regi_fl[[2]]$fajok[1,]$datum
month(regi_fl[[2]]$fajok[1,]$datum)
lapply(regi_fl, function(x) {
d <- numeric(12)
for (i in 1:length(x$fajok$datum)) {
d[month(x$fajok[i,]$datum)] <- d[month(x$fajok[i,]$datum)] + x$fajok[i,]$egyed
}
return(d)
})
regi_fl[[2]]$fajok
aktivi <- lapply(regi_fl, function(x) {
d <- numeric(12)
for (i in 1:length(x$fajok$datum)) {
d[month(x$fajok[i, ]$datum)] <- d[month(x$fajok[i, ]$datum)] + x$fajok[i, ]$egyed
}
return(d)
})
aktivi
lapply(regi_fl, function(x) {
d <- numeric(12)
for (i in 1:length(x$fajok$datum)) {
d[month(x$fajok[i, ]$datum)] <- d[month(x$fajok[i, ]$datum)] + x$fajok[i, ]$egyed
}
return(d)
})
sapply(regi_fl, function(x) {
d <- numeric(12)
for (i in 1:length(x$fajok$datum)) {
d[month(x$fajok[i, ]$datum)] <- d[month(x$fajok[i, ]$datum)] + x$fajok[i, ]$egyed
}
return(d)
})
unlist(lapply(regi_fl, function(x) {
d <- numeric(12)
for (i in 1:length(x$fajok$datum)) {
d[month(x$fajok[i, ]$datum)] <- d[month(x$fajok[i, ]$datum)] + x$fajok[i, ]$egyed
}
return(d)
}))
aktivi <- unlist(lapply(regi_fl, function(x) {
d <- numeric(12)
for (i in 1:length(x$fajok$datum)) {
d[month(x$fajok[i,]$datum)] <- d[month(x$fajok[i,]$datum)] + x$fajok[i,]$egyed
}
return(d)
}))
honapok <- c('jan', 'feb', 'mar', 'apr', 'maj', 'jun', 'jul', 'aug', 'sep', 'okt', 'nov', 'dec')
aktivi <- matrix(rep(NA, length(nevek)*length(honapok)), nrow = length(nevek))
colnames(aktivi) <- honapok
rownames(aktivi) <- nevek
aktivi <- unlist(lapply(regi_fl, function(x) {
d <- numeric(12)
for (i in 1:length(x$fajok$datum)) {
d[month(x$fajok[i,]$datum)] <- d[month(x$fajok[i,]$datum)] + x$fajok[i,]$egyed
}
return(d)
}))
aktivi
class(aktivi)
aktivi <- unlist(lapply(regi_fl, function(x) {
d <- numeric(12)
for (i in 1:length(x$fajok$datum)) {
d[month(x$fajok[i,]$datum)] <- d[month(x$fajok[i,]$datum)] + x$fajok[i,]$egyed
}
return(d)
}))
aktivi <- matrix(c(aktivi), nrow = length(nevek))
colnames(aktivi) <- honapok
rownames(aktivi) <- nevek
aktivi
aktivi <- unlist(lapply(regi_fl, function(x) {
d <- numeric(12)
for (i in 1:length(x$fajok$datum)) {
d[month(x$fajok[i,]$datum)] <- d[month(x$fajok[i,]$datum)] + x$fajok[i,]$egyed
}
return(d)
}))
aktivitas <- matrix(c(aktivi), nrow = length(nevek), byrow = T)
colnames(aktivitas) <- honapok
rownames(aktivitas) <- nevek
aktivitas
