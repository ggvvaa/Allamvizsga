dat2 <-
data.frame(
id_9,
lon = NA,
lat = NA,
fam = NA,
subfam = NA,
gen = NA,
subgen = NA,
spec = NA,
subspec = NA,
sp = NA
)
dat2 <-
data.frame(
row.names = c(
'id',
'lon',
'lat',
'fam',
'subfam',
'gen',
'subgen',
'spec',
'subspec',
'sp'
)
)
View(dat2)
dat2 <-
data.frame(
row.names = c(
'id',
'lon',
'lat',
'fam',
'subfam',
'gen',
'subgen',
'spec',
'subspec',
'sp'
)
)
new_shape_2 <-
apply(dat, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
det2[length(det2) + 1] = i
return(det2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2])
new_shape_2 <-
apply(dat, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
det2[length(det2) + 1] = i
return(det2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], det2 = det2)
new_shape_2 <-
apply(dat, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
det2[length(dat2) + 1] = i
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
c(12236, 27.253476, 47.065546, "Tipulidae", "Tipulinae", "Tipula", "(Pterelachisus)", "pseudovariipennis" , NA, 4973)
a<-c(12236, 27.253476, 47.065546, "Tipulidae", "Tipulinae", "Tipula", "(Pterelachisus)", "pseudovariipennis" , NA, 4973)
a[1]
class(a[1])
a<-c(12236, 27.253476, 47.065546, "Tipulidae", "Tipulinae", "Tipula", "(Pterelachisus)", "pseudovariipennis" , NA, 4973)
class(a[1])
a
dat2 <- a
dat2 <-
data.frame(
row.names = c(
'id',
'lon',
'lat',
'fam',
'subfam',
'gen',
'subgen',
'spec',
'subspec',
'sp'
)
)
new_shape_2 <-
apply(dat, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
det2[length(dat2) + 1] = unlist(i)
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
new_shape_2 <-
apply(dat, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
det2[length(dat2) + 1, 1] = i[1]
det2[length(dat2) + 1, 2] = i[2]
det2[length(dat2) + 1, 3] = i[3]
det2[length(dat2) + 1, 4] = i[4]
det2[length(dat2) + 1, 5] = i[5]
det2[length(dat2) + 1, 6] = i[6]
det2[length(dat2) + 1, 7] = i[7]
det2[length(dat2) + 1, 8] = i[8]
det2[length(dat2) + 1, 9] = i[9]
det2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
dat2 <-
data.frame(
id = NA,
lon = NA,
lat = NA,
fam = NA,
subfam = NA,
gen = NA,
subgen = NA,
spec = NA,
subspec = NA,
sp = sp
)
dat2 <-
data.frame(
id = NA,
lon = NA,
lat = NA,
fam = NA,
subfam = NA,
gen = NA,
subgen = NA,
spec = NA,
subspec = NA,
sp = NA
)
new_shape_2 <-
apply(dat, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
det2[length(dat2) + 1, 1] = i[1]
det2[length(dat2) + 1, 2] = i[2]
det2[length(dat2) + 1, 3] = i[3]
det2[length(dat2) + 1, 4] = i[4]
det2[length(dat2) + 1, 5] = i[5]
det2[length(dat2) + 1, 6] = i[6]
det2[length(dat2) + 1, 7] = i[7]
det2[length(dat2) + 1, 8] = i[8]
det2[length(dat2) + 1, 9] = i[9]
det2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
new_shape_2 <-
apply(dat, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat[length(dat2) + 1, 1] = i[1]
dat[length(dat2) + 1, 2] = i[2]
dat[length(dat2) + 1, 3] = i[3]
dat[length(dat2) + 1, 4] = i[4]
dat[length(dat2) + 1, 5] = i[5]
dat[length(dat2) + 1, 6] = i[6]
dat[length(dat2) + 1, 7] = i[7]
dat[length(dat2) + 1, 8] = i[8]
dat[length(dat2) + 1, 9] = i[9]
dat[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
new_shape_2 <-
apply(dat2, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1, 1] = i[1]
dat2[length(dat2) + 1, 2] = i[2]
dat2[length(dat2) + 1, 3] = i[3]
dat2[length(dat2) + 1, 4] = i[4]
dat2[length(dat2) + 1, 5] = i[5]
dat2[length(dat2) + 1, 6] = i[6]
dat2[length(dat2) + 1, 7] = i[7]
dat2[length(dat2) + 1, 8] = i[8]
dat2[length(dat2) + 1, 9] = i[9]
dat2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
new_shape_2 <-
apply(dat2, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1, 1] = i[1]
# dat2[length(dat2) + 1, 2] = i[2]
# dat2[length(dat2) + 1, 3] = i[3]
# dat2[length(dat2) + 1, 4] = i[4]
# dat2[length(dat2) + 1, 5] = i[5]
# dat2[length(dat2) + 1, 6] = i[6]
# dat2[length(dat2) + 1, 7] = i[7]
# dat2[length(dat2) + 1, 8] = i[8]
# dat2[length(dat2) + 1, 9] = i[9]
# dat2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
new_shape_2 <-
apply(dat2, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1, 1] = i[1]
# dat2[length(dat2) + 1, 2] = i[2]
# dat2[length(dat2) + 1, 3] = i[3]
# dat2[length(dat2) + 1, 4] = i[4]
# dat2[length(dat2) + 1, 5] = i[5]
# dat2[length(dat2) + 1, 6] = i[6]
# dat2[length(dat2) + 1, 7] = i[7]
# dat2[length(dat2) + 1, 8] = i[8]
# dat2[length(dat2) + 1, 9] = i[9]
# dat2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2])
View(dat2)
new_shape_2 <-
apply(dat2, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1, 1] = i[1]
# dat2[length(dat2) + 1, 2] = i[2]
# dat2[length(dat2) + 1, 3] = i[3]
# dat2[length(dat2) + 1, 4] = i[4]
# dat2[length(dat2) + 1, 5] = i[5]
# dat2[length(dat2) + 1, 6] = i[6]
# dat2[length(dat2) + 1, 7] = i[7]
# dat2[length(dat2) + 1, 8] = i[8]
# dat2[length(dat2) + 1, 9] = i[9]
# dat2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 <-
data.frame(
id = NA,
lon = NA,
lat = NA,
fam = NA,
subfam = NA,
gen = NA,
subgen = NA,
spec = NA,
subspec = NA,
sp = NA
))
remove(dat2)
dat2 = matrix()
new_shape_2 <-
apply(dat2, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1, 1] = i[1]
# dat2[length(dat2) + 1, 2] = i[2]
# dat2[length(dat2) + 1, 3] = i[3]
# dat2[length(dat2) + 1, 4] = i[4]
# dat2[length(dat2) + 1, 5] = i[5]
# dat2[length(dat2) + 1, 6] = i[6]
# dat2[length(dat2) + 1, 7] = i[7]
# dat2[length(dat2) + 1, 8] = i[8]
# dat2[length(dat2) + 1, 9] = i[9]
# dat2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = matrix())
dat2 <-
data.frame(
id = NA,
lon = NA,
lat = NA,
fam = NA,
subfam = NA,
gen = NA,
subgen = NA,
spec = NA,
subspec = NA,
sp = NA
)
new_shape_2 <-
apply(dat, 1, function(i, x, y, dat2) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1, 1] = i[1]
# dat2[length(dat2) + 1, 2] = i[2]
# dat2[length(dat2) + 1, 3] = i[3]
# dat2[length(dat2) + 1, 4] = i[4]
# dat2[length(dat2) + 1, 5] = i[5]
# dat2[length(dat2) + 1, 6] = i[6]
# dat2[length(dat2) + 1, 7] = i[7]
# dat2[length(dat2) + 1, 8] = i[8]
# dat2[length(dat2) + 1, 9] = i[9]
# dat2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
new_shape_2$`1`
new_shape_2 <-
apply(dat, 1, function(i, x, y, dat2) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1, 1] = i[1]
dat2[length(dat2) + 1, 2] = i[2]
dat2[length(dat2) + 1, 3] = i[3]
dat2[length(dat2) + 1, 4] = i[4]
dat2[length(dat2) + 1, 5] = i[5]
dat2[length(dat2) + 1, 6] = i[6]
dat2[length(dat2) + 1, 7] = i[7]
dat2[length(dat2) + 1, 8] = i[8]
dat2[length(dat2) + 1, 9] = i[9]
dat2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
dat2 <- data.frame(row.names = c('id', 'lon', 'lat', 'fam', 'subfam', 'gen', 'subgen', 'spec', 'subspec', 'sp'))
new_shape_2 <-
apply(dat, 1, function(i, x, y, dat2) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1, 1] = i[1]
dat2[length(dat2) + 1, 2] = i[2]
dat2[length(dat2) + 1, 3] = i[3]
dat2[length(dat2) + 1, 4] = i[4]
dat2[length(dat2) + 1, 5] = i[5]
dat2[length(dat2) + 1, 6] = i[6]
dat2[length(dat2) + 1, 7] = i[7]
dat2[length(dat2) + 1, 8] = i[8]
dat2[length(dat2) + 1, 9] = i[9]
dat2[length(dat2) + 1, 10] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
new_shape_2
new_shape_2 <-
apply(dat, 1, function(i, x, y, dat2) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1] = i[1]
dat2[length(dat2) + 1] = i[2]
dat2[length(dat2) + 1] = i[3]
dat2[length(dat2) + 1] = i[4]
dat2[length(dat2) + 1] = i[5]
dat2[length(dat2) + 1] = i[6]
dat2[length(dat2) + 1] = i[7]
dat2[length(dat2) + 1] = i[8]
dat2[length(dat2) + 1] = i[9]
dat2[length(dat2) + 1] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
new_shape_2
new_shape_2 <-
apply(dat, 1, function(i, x, y, dat2) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
dat2[length(dat2) + 1] = i
# dat2[length(dat2) + 1] = i[2]
# dat2[length(dat2) + 1] = i[3]
# dat2[length(dat2) + 1] = i[4]
# dat2[length(dat2) + 1] = i[5]
# dat2[length(dat2) + 1] = i[6]
# dat2[length(dat2) + 1] = i[7]
# dat2[length(dat2) + 1] = i[8]
# dat2[length(dat2) + 1] = i[9]
# dat2[length(dat2) + 1] = i[10]
return(dat2)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2], dat2 = dat2)
new_shape_2
unlist(new_shape_2)
new_shape_2
new_shape_2 <-
apply(dat, 1, function(i, x, y) {
if (point.in.polygon(i[2], i[3], x, y) == 1) {
# dat2[length(dat2) + 1] = i
# # dat2[length(dat2) + 1] = i[2]
# # dat2[length(dat2) + 1] = i[3]
# # dat2[length(dat2) + 1] = i[4]
# # dat2[length(dat2) + 1] = i[5]
# # dat2[length(dat2) + 1] = i[6]
# # dat2[length(dat2) + 1] = i[7]
# # dat2[length(dat2) + 1] = i[8]
# # dat2[length(dat2) + 1] = i[9]
# # dat2[length(dat2) + 1] = i[10]
return(i)
}
}, x = rom@polygons[[1]]@Polygons[[1]]@coords[, 1], y = rom@polygons[[1]]@Polygons[[1]]@coords[, 2])
new_shape_2
na.omit(new_shape_2)
class(new_shape_2)
unlist(new_shape_2)
unlist(unlist(new_shape_2))
new_shape_2 <- unlist(new_shape_2)
class(new_shape_2)
new_shape_1 <-
point.in.polygon(
dat$lon,
dat$lat,
rom@polygons[[1]]@Polygons[[1]]@coords[, 1],
rom@polygons[[1]]@Polygons[[1]]@coords[, 2]
)
new_shape_1
remove(dat2)
remove(new_shape_2)
a <- numeric(0)
for (i in 1:length(new_shape_1)) {
if (new_shape_1[i] == 0) {
a[length(a) + 1] = i
}
}
a
dat <- dat[-a, ]
plot(regi)
points(dat$lat ~ dat$lon, col = "red")
View(dat)
library(rgdal)
library(ggplot2)
ggplot() +  geom_point(data=dat, aes(x=lon, y=lat), color="red")
ggplot() +  geom_point(data=dat, aes(x=lat, y=lon), color="red")
ggplot() +  geom_point(data=dat, aes(x=lon, y=lat), color="red")
ggplot() +  geom_point(data=dat, aes(x=lon, y=lat), color="red") + geom_polygon(data=regi)
regi@polygons[[1:10]]@Polygons[[1]]@coords[,1]
regi@polygons[[1:2]]@Polygons[[1]]@coords[,1]
ggplot(regi) +  geom_point(data=dat, aes(x=lon, y=lat), color="red")
ggplot(regi@polygons) +  geom_point(data=dat, aes(x=lon, y=lat), color="red")
regi@data$ID
regi_t <- regi
regi_t@data$ID = rownames(regi_t@data)
regi@data$ID
rownames(regi_t@data)
regi_t@data$ID <- rownames(regi_t@data)
regi@data$ID
regi_t@data$ID
regi_t@data$ID <- as.integer(rownames(regi_t@data))
regi_t@data$ID
regi_t.fort <- fortify(regi_t, region = 'ID')
install.packages("maptools")
regi_t.fort <- fortify(regi_t, region = 'ID')
regi_t.fort
regi_t@data$ID <- as.character(rownames(regi_t@data$DENUMIRE))
as.character(rownames(regi_t@data$DENUMIRE))
as.character(regi_t@data$DENUMIRE)
regi_t@data$ID <- as.character(regi_t@data$DENUMIRE)
regi_t@data$ID
regi_t.fort <- fortify(regi_t, region = 'ID')
regi_t.fort
regi_t.fort <- regi_t.fort[order(regi_t.fort$order), ]
regi_t.fort
ggplot() + geom_point(data=dat, aes(x=lon, y=lat), color="red") + geom_polygon(data = regi, aes(long, lat, group=group))
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group)) + geom_point(data=dat, aes(x=lon, y=lat), color="red")
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color="red")
dat
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=spec)
dat_t <- dat
dat_t.fort <- fortify(dat_t, region = dat_t$subspec)
dat_t.fort
ggplot()  + geom_polygon(data = regi_t.fort, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=spec)
ggplot()  + geom_polygon(data = regi_t.fort, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat))
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat))
regi
ggplot()  + geom_polygon(data = regi, aes(long, lat), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat))
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat))
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$spec)
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=c(dat$spec))
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$sp)
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$sp)
ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$sp)
mp <- ggplot()  + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$sp)
mp <- ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$sp)
mp
ggplot() + geom_polygon(
data = regi,
aes(long, lat, group = group),
colour = 'black',
fill = 'white'
) + geom_point(data = dat, aes(x = lon, y = lat), color = dat$sp) + scale_fill_brewer(palette =
"Dark2")
mp <- ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$sp)
mp + scale_fill_brewer(palette="Dark2")
mp + scale_fill_brewer(palette="YlOrRd")
mp <- ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat))
mp + scale_fill_brewer(palette="YlOrRd")
mp <- ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$id)
mp
mp + scale_fill_brewer(palette="YlOrRd")
ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=mpg)
dataset <- data.frame(category = rep(LETTERS[1:5], 100),
x = rnorm(500, mean = rep(1:5, 100)),
y = rnorm(500, mean = rep(1:5, 100)))
dataset
dataset$fCategory <- factor(dataset$category)
dataset
plot(regi)
points(dat$lat ~ dat$lon, col = "red")
ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=mpg)
ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$id)
View(dat)
ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=dat$sp)
ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color=red)
ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color='red')
remove(dat_t, dat_t.fort)
remove(b)
remove(regi_t.fort)
remove(regi_t)
regi
regi@polygons[[1]]
regi@data$ID
regi@plotOrder
length(regi@polygons)
length(regi@polygons@Polygons)
length(regi@polygons@Polygons[[]])
length(regi@Polygons)
nPolys <- sapply(regi@polygons, function(x)length(x@Polygons))
nPolys
region <- regi[which(nPolys==max(nPolys)),]
region
remove(region)
ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color='red',size=4)
ggplot() + geom_polygon(data = regi, aes(long, lat, group=group), colour='black',fill='white') + geom_point(data=dat, aes(x=lon, y=lat), color='red',size=2)
